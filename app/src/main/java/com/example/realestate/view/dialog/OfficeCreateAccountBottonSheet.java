package com.example.realestate.view.dialog;import android.Manifest;import android.content.Intent;import android.content.pm.PackageManager;import android.net.Uri;import android.os.Bundle;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.view.animation.AnimationUtils;import android.widget.EditText;import android.widget.ImageView;import android.widget.Toast;import androidx.annotation.NonNull;import androidx.annotation.Nullable;import androidx.core.app.ActivityCompat;import androidx.core.content.ContextCompat;import com.example.realestate.R;import com.example.realestate.model.entity.Office;import com.example.realestate.view.activity.MainActivity;import com.google.android.material.bottomsheet.BottomSheetDialogFragment;import br.com.simplepass.loadingbutton.customViews.CircularProgressButton;import static android.app.Activity.RESULT_OK;public class OfficeCreateAccountBottonSheet extends BottomSheetDialogFragment {    public static final int REQUEST_PERMISSION_EXTERNAL = 20;    private static final int REQUEST_CODE_GALLERY = 100;    private EditText edtBottomSheetName;    private EditText edtBottomSheetPhoneNumber;    private EditText edtBottomSheetPassword;    private ImageView btnBottomSheetCreateOfficeGallary;    private String imageProfile="";    private CircularProgressButton btnBottomSheetSingUp;    @Nullable    @Override    public View onCreateView(@NonNull LayoutInflater inflater,                             @Nullable ViewGroup container,                             @Nullable Bundle savedInstanceState) {        View view = inflater.inflate( R.layout.bottom_sheet_office_create_acount, container );        edtBottomSheetName = view.findViewById( R.id.edtBottomSheetName );        edtBottomSheetPhoneNumber = view.findViewById( R.id.edtBottomSheetPhoneNumber );        edtBottomSheetPassword = view.findViewById( R.id.edtBottomSheetPassword );        btnBottomSheetSingUp = view.findViewById( R.id.btnBottomSheetSingUp );        btnBottomSheetCreateOfficeGallary = view.findViewById( R.id.btnBottomSheetCreateOfficeGallary );        btnBottomSheetCreateOfficeGallary.setOnClickListener( new View.OnClickListener() {            @Override            public void onClick(View view) {                view.startAnimation( AnimationUtils.loadAnimation( getActivity(), R.anim.scale_animation ) );                if (checkPermissionsExternal()) {                    openGallery();                } else {                    requestRuntimePermissionsExternal();                }            }        } );        btnBottomSheetSingUp.setOnClickListener( new View.OnClickListener() {            @Override            public void onClick(View view) {                String name = edtBottomSheetName.getText().toString().trim();                String numberPhone = edtBottomSheetPhoneNumber.getText().toString().trim();                String password = edtBottomSheetPassword.getText().toString().trim();                if (name.equals( "" )) {                    edtBottomSheetName.setError( "Faild can't be Empty" );                    return;                }                if (numberPhone.equals( "" )) {                    edtBottomSheetPhoneNumber.setError( "Faild can't be Empty" );                    return;                }                if (password.equals( "" )) {                    edtBottomSheetPassword.setError( "Faild can't be Empty" );                    return;                }                if (imageProfile.equals( "" )){                    Toast.makeText( getActivity(), "Please select image profile .", Toast.LENGTH_SHORT ).show();                    return;                }                ((MainActivity) getActivity()).officeinset( new Office( 0, name, numberPhone,imageProfile ) );                btnBottomSheetSingUp.startAnimation();                Toast.makeText( getActivity(), "Sing Up sucsses", Toast.LENGTH_SHORT ).show();                ((MainActivity) getActivity()).getAllOffice();                ((MainActivity) getActivity()).setNumberFromDialogCreateOffice( numberPhone );                dismiss();            }        } );        return view;    }    public boolean checkPermissionsExternal() {        if (ContextCompat.checkSelfPermission( getActivity(), Manifest.permission.READ_EXTERNAL_STORAGE ) == PackageManager.PERMISSION_DENIED ||                ContextCompat.checkSelfPermission( getActivity(), Manifest.permission.WRITE_EXTERNAL_STORAGE ) == PackageManager.PERMISSION_DENIED) {            return false;        }        return true;    }    public void openGallery() {        Intent intent = new Intent();        intent.setType( "image/*" );        intent.setAction( Intent.ACTION_GET_CONTENT );        startActivityForResult( intent, REQUEST_CODE_GALLERY );    }    private void requestRuntimePermissionsExternal() {        ActivityCompat.requestPermissions( getActivity(),                new String[]{Manifest.permission.READ_EXTERNAL_STORAGE, Manifest.permission.WRITE_EXTERNAL_STORAGE},                REQUEST_PERMISSION_EXTERNAL );    }    @Override    public void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {        super.onActivityResult( requestCode, resultCode, data );        if (resultCode == RESULT_OK) {            switch (requestCode) {                case REQUEST_CODE_GALLERY:                    if (data.getData() != null) {                        Uri uri = data.getData();                        imageProfile = uri.toString();                    }                    break;            }        }    }}